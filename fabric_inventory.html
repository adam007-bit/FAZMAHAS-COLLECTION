<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fabric Inventory System</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; padding:10px; }
    h1, h2 { text-align:center; }
    .container { max-width:900px; margin:auto; }
    .card { background:#fff; padding:15px; margin-bottom:15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    input, select, button { width:100%; padding:8px; margin:5px 0; }
    button { background:#007bff; color:#fff; border:none; border-radius:5px; }
    button:hover { background:#0056b3; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { border:1px solid #ccc; padding:8px; text-align:center; }
    th { background:#eee; }
    .low { background:#ffdddd; }
    .hidden { display:none; }
  </style>
</head>
<body>

<div class="container">

<!-- LOGIN -->
<div id="loginBox" class="card">
  <h2>Login</h2>
  <select id="role">
    <option value="admin">Admin</option>
    <option value="staff">Staff</option>
  </select>
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- SYSTEM -->
<div id="systemBox" class="hidden">

<h1>Fabric Inventory System</h1>

<div class="card">
  <h2>Add Record</h2>
  <input type="date" id="date">
  <input type="text" id="supplier" placeholder="Supplier Name">
  <input type="text" id="fabricName" placeholder="Fabric Name">
  <select id="fabricType">
    <option>Cotton</option>
    <option>Silk</option>
    <option>Denim</option>
    <option>Polyester</option>
  </select>
  <input type="number" id="meters" placeholder="Meters">
  <select id="action">
    <option value="in">Stock In</option>
    <option value="out">Stock Out</option>
  </select>
  <button onclick="addRecord()">Save</button>
</div>

<div class="card">
  <h2>Inventory</h2>
  <table>
    <thead>
      <tr>
        <th>Fabric</th>
        <th>Type</th>
        <th>In (m)</th>
        <th>Out (m)</th>
        <th>Balance (m)</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<div class="card">
  <h2>Monthly Usage Report</h2>
  <input type="month" id="reportMonth">
  <button onclick="generateReport()">Generate</button>
  <div id="reportResult"></div>
</div>

</div>
</div>

<script>
  let inventory = JSON.parse(localStorage.getItem('inventory')) || {};
  let records = JSON.parse(localStorage.getItem('records')) || [];

  function login() {
    const role = document.getElementById('role').value;
    const pass = document.getElementById('password').value;
    if ((role === 'admin' && pass === 'admin123') || (role === 'staff' && pass === 'staff123')) {
      loginBox.classList.add('hidden');
      systemBox.classList.remove('hidden');
      renderTable();
    } else alert('Wrong password');
  }

  function addRecord() {
    const name = fabricName.value;
    const type = fabricType.value;
    const metersVal = Number(meters.value);
    const act = action.value;
    const dateVal = date.value;
    const supplierVal = supplier.value;

    if (!name || metersVal <= 0) return alert('Invalid data');

    if (!inventory[name]) inventory[name] = { type:type, in:0, out:0 };
    if (act === 'in') inventory[name].in += metersVal;
    else inventory[name].out += metersVal;

    records.push({ name, act, meters:metersVal, date:dateVal, supplier:supplierVal });

    localStorage.setItem('inventory', JSON.stringify(inventory));
    localStorage.setItem('records', JSON.stringify(records));

    renderTable();
    meters.value = '';
  }

  function renderTable() {
    tableBody.innerHTML = '';
    for (let item in inventory) {
      const d = inventory[item];
      const bal = d.in - d.out;
      tableBody.innerHTML += `
        <tr class="${bal < 10 ? 'low' : ''}">
          <td>${item}</td>
          <td>${d.type}</td>
          <td>${d.in}</td>
          <td>${d.out}</td>
          <td>${bal}</td>
        </tr>`;
    }
  }

  function generateReport() {
    const month = reportMonth.value;
    let total = 0;
    records.forEach(r => {
      if (r.act === 'out' && r.date.startsWith(month)) total += r.meters;
    });
    reportResult.innerHTML = `<b>Total Fabric Used:</b> ${total} meters`;
  }
</script>

</body>
</html>
